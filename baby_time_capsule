from Crypto.Util.number import long_to_bytes
from sympy import * # type: ignore
from sympy.ntheory.modular import crt
from sympy.simplify.simplify import nthroot

c1 = "3C052C324E419CD095C064F8D5DD288D8A06B8FB6FC6B19A484E65D82BC38EE68E8329B5BF0991CB52E5567E9CD4D9FFF11FAD2E86F961789F57BE13B9C2ABAA952E129821A4436075F4EA95FDAED7CF17E60F9D486184D1E0436F5C25F191463843A1633DAEC8579D32BFBCAAA4FCA6DF163C32D9109AA7ECB4E1EA5F8EBA5F"
c2 = "C66C209DD435C4FA7E06D91A3721605A88699663EF909C1D3D0F338988B65F54F4DCB2A732A83D5B338BA14438F0C5C393DA1FE3CB5C0542A063CD08EB6B06EAFCC36980F0EBD5B0CCCBE405A1B5C1E2CCFD694EC7D1FFA9034180C9F566957A1FBB98739FF4BB30C95ECF1D77469AF4DA31B282E87E747D929CB1912CB5DD5"
c3 = "4EFE2DC7459893483F6E26A508D5AEDA346E90CEA7A2C613F2F6B46363D704CD95FA771E9EFCA4D3D42E88BD01E7D2D3D017A64E11CAF83FBCDBD29CEFA3423D5EF53DC660E5A753191E151330931F8497DEAA8CCED4968E376F4E2D6EAEDE220C0194025324C2824D7C1455C214CA2C66A4C887FE66251D169D7EAFA19E873C"

n1 = "69718CDFF3891BD5127541AE29FC0FD394D2BE9E6B495FB87384862DA799599C71680B8F8DCB9120168C668EC0B304AF42670F23B190B03B390A2BC89A63BE316226709A05DF4E8D9262ADDCCB0F07964EF1A1683EEAC001F6BFD499EA03A512E1F95605FE9D4FFD1A4BC13E2F3F53EDA4A95095C7E84013D13C0EE5DF0D4A67"
n2 = "B98FC20C70706A03060B1D460BAD10C3F70CDD64BA2E9C0FD5A906F2089AFA1338ACB63A54078B23914CDA55946D9AEDF2CB6D8C800170FAFA9F23EAD7309C9940BD35A91A41F5C462B2B9E3E309EC89206CDDFCCD830F38DCFC1FE13CC691325F74995CE9BEEF04466EAD2B66522AF5BD62816CEDEE59F56CDA60EEDA38DFBB"
n3 = "82907B4A3F212637D7B14BA150B4D7CB6E63665BF88319B0D1B90157DA0506FD1881920D5B293CBD3E7016636667EEA6CE71CBEF23751EDB4436EA5D30979FC6D3F43AF5AE66BE9B9C3B7739FA6C5F9192A7BA61B32CAE79739A73E492E902F6C3AEC39241C5B337AB905CCF5EDD9219D22517B6DE1D733AEB01F98781B72823"

cipher_list = [c1,c2,c3]
n_list = [n1,n2,n3]

x_list = crt([int(n,16) for n in n_list], [int(c,16) for c in cipher_list], check=True)

flag = nthroot(x_list[0], 5)

print(f"flag:{flag}")

print(long_to_bytes(flag))
